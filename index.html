<!DOCTYPE html>
<!--<html>-->
<!--    <head>-->
<!--        <meta charset="utf-8">-->
<!--        <meta name="viewport" content="width=device-width">-->
<!--        <title>Clock</title>-->
<!--        <link rel="manifest" href="/manifest.json">-->
<!--        <link rel="stylesheet" type="text/css" href="style.css">-->
<!--    </head>-->
<!--    <body>-->
<!--        <canvas id="face"></canvas>-->
<!--        <pre id="clock"></pre>-->
<!--        <div id="grab">-->
<!--            <svg height="64" class="octicon octicon-grabber" viewBox="0 0 8 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M8 4v1H0V4h8zM0 8h8V7H0v1zm0 3h8v-1H0v1z"></path></svg>-->
<!--        </div>-->
<!--        <script src="jquery.js"></script>-->
        <!--<script src="weedit.js"></script>-->
<!--        <script type="module" src="index.js"></script>-->
<!--    </body>-->
<!--</html>-->
<html lang="en">
<head>
<meta charset="UTF-8">
<link rel="manifest" href="/manifest.json">
<title>Transparent Edge-to-Edge Analog Clock</title>
<style>
    html, body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background: #222;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    video {
        width: 320px;
        height: 320px;
        background: transparent; /* transparent outside circle */
        border: none;
        display: block;
    }
</style>
</head>
<body>
<video id="vid" autoplay muted playsinline></video>
<canvas id="clock" width="320" height="320" style="display:none"></canvas>

<script>
const canvas = document.getElementById('clock');
const ctx = canvas.getContext('2d', { alpha: true }); // enable transparency
const vid = document.getElementById('vid');
vid.srcObject = canvas.captureStream(30);
vid.play();

function drawClock() {
    const now = new Date();
    const size = canvas.width;
    const radius = size / 2 - 3; // red circle touches edges

    ctx.clearRect(0, 0, size, size);

    // Draw transparent background with circle mask
    ctx.save();
    ctx.beginPath();
    ctx.arc(size / 2, size / 2, radius, 0, 2 * Math.PI);
    ctx.clip();

    // Fill only inside circle with light yellow
    ctx.fillStyle = '#fffcb0';
    ctx.fillRect(0, 0, size, size);

    // Clock border (red)
    ctx.beginPath();
    ctx.arc(size / 2, size / 2, radius, 0, 2 * Math.PI);
    ctx.lineWidth = 6;
    ctx.strokeStyle = 'red';
    ctx.stroke();

    ctx.translate(size / 2, size / 2);
    ctx.rotate(-Math.PI / 2);

    const sec = now.getSeconds();
    const min = now.getMinutes();
    const hr = (now.getHours() % 12) + min / 60;

    // Hour hand
    ctx.save();
    ctx.rotate((Math.PI / 6) * hr);
    ctx.lineWidth = 6;
    ctx.strokeStyle = 'rgba(255,0,0,0.5)';
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.lineTo(radius * 0.4, 0);
    ctx.stroke();
    ctx.restore();

    // Minute hand
    ctx.save();
    ctx.rotate((Math.PI / 30) * min);
    ctx.lineWidth = 4;
    ctx.strokeStyle = 'rgba(255,0,0,0.3)';
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.lineTo(radius * 0.6, 0);
    ctx.stroke();
    ctx.restore();

    // Second hand
    ctx.save();
    ctx.rotate((Math.PI / 30) * sec);
    ctx.lineWidth = 2;
    ctx.strokeStyle = 'rgba(255,0,0,0.2)';
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.lineTo(radius * 0.8, 0);
    ctx.stroke();
    ctx.restore();

    ctx.restore();

    // Date + time text
    const dateStr = now.toLocaleDateString(undefined, {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });
    const timeStr = now.toLocaleTimeString();

    ctx.fillStyle = '#000';
    ctx.font = '16px monospace';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(dateStr.split(',')[0], size / 2, size / 2 - 20);
    ctx.fillText(dateStr.replace(/^[^,]+, /, ''), size / 2, size / 2);
    ctx.font = 'bold 18px monospace';
    ctx.fillText(timeStr, size / 2, size / 2 + 25);
}

function tick() {
    drawClock();
    setTimeout(tick, 1000 - (Date.now() % 1000));
}
tick();
</script>
</body>
</html>
